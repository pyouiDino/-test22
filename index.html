<!doctype html>

<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Devine la carte — Jeu</title>
  <style>
    :root{--bg:#f3f4f6;--card:#fff;--accent:#0ea5a4;--muted:#6b7280}
    *{box-sizing:border-box;font-family:Inter,ui-sans-serif,system-ui,Segoe UI,Roboto,'Helvetica Neue',Arial}
    body{margin:0;background:linear-gradient(180deg,var(--bg),#e9eef2);min-height:100vh;display:flex;align-items:center;justify-content:center;padding:20px}
    .wrap{width:100%;max-width:880px;background:var(--card);border-radius:14px;box-shadow:0 10px 30px rgba(2,6,23,0.08);padding:22px}
    header{display:flex;align-items:center;justify-content:space-between;margin-bottom:16px}
    h1{font-size:20px;margin:0}
    .balance{font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, monospace;font-weight:700}
    .controls{display:flex;gap:10px;align-items:center;margin-bottom:12px}
    input[type=number]{padding:10px;border-radius:8px;border:1px solid #e6e9ee;width:160px}
    button{background:var(--accent);color:#fff;border:0;padding:10px 14px;border-radius:8px;cursor:pointer}
    button.secondary{background:#e6e9ee;color:#111}
    .cards{display:grid;grid-template-columns:repeat(4,1fr);gap:10px;margin-bottom:14px}
    .card{background:#f8fafc;border-radius:10px;border:1px solid #e6edf0;padding:16px;text-align:center;font-weight:700;cursor:pointer;user-select:none}
    .card.disabled{opacity:0.5;cursor:not-allowed}
    .hidden-card{height:92px;display:flex;align-items:center;justify-content:center;border-radius:10px;background:#111;color:#fff;font-weight:700}
    .revealed{height:92px;display:flex;align-items:center;justify-content:center;border-radius:10px;background:#fff;border:1px solid #e6edf0;font-weight:800}
    .msg{background:#f8fafc;padding:12px;border-radius:8px;border:1px solid #eef2f5;color:#0f172a}
    footer{margin-top:12px;color:var(--muted);font-size:13px}
    .small{font-size:13px;color:var(--muted)}
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Devine la carte</h1>
      <div>
        <div class="small">Solde</div>
        <div class="balance" id="balance">10000</div>
      </div>
    </header><div class="controls">
  <label for="bet" class="small">Mise (min 1000)</label>
  <input id="bet" type="number" min="1000" step="100" value="1000">
  <button id="startBtn">Démarrer la partie</button>
  <button id="resetBtn" class="secondary">Réinitialiser</button>
</div>

<div class="small">Choisis la carte que tu penses être sur le dessus :</div>
<div class="cards" id="choices">
  <div class="card" data-card="Dame">Dame</div>
  <div class="card" data-card="Roi">Roi</div>
  <div class="card" data-card="Valet">Valet</div>
  <div class="card" data-card="As">As</div>
</div>

<div style="margin:14px 0;">
  <div id="top" class="hidden-card">Carte face cachée</div>
</div>

<div class="msg" id="message">Bienvenue — place ta mise et démarre la partie.</div>

<footer>
  Règles : mise minimale 1000. Si tu gagnes, ta mise est rendue ×2 (tu gagnes ta mise en plus). Si tu perds, tu perds ta mise. Tu peux rejouer tant que ton solde est suffisant.
</footer>

  </div>  <script>
    (function(){
      const CARDS = ['Dame','Roi','Valet','As'];
      const minBet = 1000;
      let balanceEl = document.getElementById('balance');
      let betEl = document.getElementById('bet');
      let startBtn = document.getElementById('startBtn');
      let resetBtn = document.getElementById('resetBtn');
      let choices = document.getElementById('choices');
      let topEl = document.getElementById('top');
      let msgEl = document.getElementById('message');

      let balance = 10000;
      let currentBet = 1000;
      let playing = false;
      let topCard = null;

      function renderBalance(){ balanceEl.textContent = balance; }
      function setMessage(s){ msgEl.textContent = s; }

      function drawCard(){ return CARDS[Math.floor(Math.random()*CARDS.length)]; }

      function validateBet(v){
        v = Math.floor(Number(v) || 0);
        if(v < minBet) return {ok:false,err:`La mise minimale est ${minBet}.`};
        if(v > balance) return {ok:false,err:`Tu n'as pas assez de crédits.`};
        return {ok:true,val:v};
      }

      startBtn.addEventListener('click', ()=>{
        const v = validateBet(betEl.value);
        if(!v.ok){ setMessage(v.err); return; }
        currentBet = v.val;
        playing = true;
        topCard = drawCard();
        topEl.className = 'hidden-card';
        topEl.textContent = 'Carte face cachée';
        setMessage('Partie lancée — choisis la carte que tu penses être sur le dessus.');
        updateChoiceButtons();
      });

      resetBtn.addEventListener('click', ()=>{
        balance = 10000; currentBet = 1000; betEl.value = 1000; playing=false; topCard=null; renderBalance();
        topEl.className='hidden-card'; topEl.textContent='Carte face cachée'; setMessage('Jeu réinitialisé.'); updateChoiceButtons();
      });

      choices.addEventListener('click', (e)=>{
        const btn = e.target.closest('.card');
        if(!btn) return;
        const guess = btn.getAttribute('data-card');
        if(!playing){ setMessage("Commence une partie d'abord."); return; }

        // validate bet again
        const v = validateBet(betEl.value);
        if(!v.ok){ setMessage(v.err); return; }
        currentBet = v.val;

        // take the bet immediately
        balance -= currentBet;
        renderBalance();

        // reveal
        topEl.className='revealed'; topEl.textContent = topCard;

        if(guess === topCard){
          const payout = currentBet * 2; // player receives 2x bet
          balance += payout;
          setMessage(`Bravo ! C'était ${topCard}. Tu remportes ${payout} (ta mise ×2).`);
        } else {
          setMessage(`Dommage — c'était ${topCard}. Tu perds ta mise de ${currentBet}.`);
        }

        renderBalance();
        playing = false; topCard = null; updateChoiceButtons();
      });

      function updateChoiceButtons(){
        const buttons = document.querySelectorAll('.card');
        buttons.forEach(b=>{
          if(!playing) b.classList.add('disabled'); else b.classList.remove('disabled');
        });
      }

      // initial render
      renderBalance(); updateChoiceButtons();

      // Accessibility: allow Enter on bet to start
      betEl.addEventListener('keydown', (e)=>{ if(e.key==='Enter') startBtn.click(); });

      // --- Note for the author: math fairness ---
      // Avec probabilité 1/4 de gagner et paiement x2, l'espérance par unité mise = 0.5.
      // Autrement dit, à long terme le joueur perd en moyenne 50% de chaque unité misée.
      // Si tu veux un jeu "équitable" (espérance = 1), il faudrait payer x4 en cas de victoire.
    })();
  </script></body>
</html>